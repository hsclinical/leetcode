My Idea:
recursive + cache

Other Solution:
